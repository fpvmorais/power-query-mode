;;; power-query-mode.el --- major mode for editing POWER-QUERY code. -*- coding: utf-8; lexical-binding: t; -*-

;; Copyright Â© 2019, by fpvmorais@gmail.com

;; Author: Pedro Morais ( fpvmorais@gmail.com )
;; Version: 1.0
;; Created: Sun Oct 27 18:15:12 HGMT 2019

;; Keywords: languages
;; Homepage: TODO: github repo

;; This file is not part of GNU Emacs.

;;; License:

;; You can redistribute this program and/or modify it under the terms of the GNU General Public License version 2.

;;;###autoload
(add-to-list 'auto-mode-alist
             (cons (concat "\\." (regexp-opt '("pq" "m") t) "\\'")
                   'power-query-mode))

;; each category of keyword is given a particular face
(setq power-query-font-lock-keywords
      (let* (
            ;; define several category of keywords
            (x-keywords '("let" "in"))
            ;(x-types '("float" "integer" "key" "list" "rotation" "string" "vector"))
            ;(x-constants '("ACTIVE" "AGENT" "ALL_SIDES" "ATTACH_BACK"))
            ;(x-events '("at_rot_target" "at_target" "attach"))
            (x-functions '(
                           "AI.ExecuteInProc"
                           "AI.ExecuteInternal"
                           "AI.ExternalSort"
                           "AI.GetAutoMLEntity"
                           "AI.SampleStratifiedWithHoldout"
                           "AI.TestConnection"
                           "AIInsights.Capacities"
                           "AIInsights.Contents"
                           "AML.Execute"
                           "AML.ExecuteBatch"
                           "Access.Database"
                           "AccessControlEntry.ConditionContextType"
                           "AccessControlEntry.ConditionToIdentities"
                           "AccessControlEntry.Type"
                           "AccessControlKind.Allow"
                           "AccessControlKind.Deny"
                           "AccessControlKind.Type"
                           "ActiveDirectory.Domains"
                           "AdoDotNet.DataSource"
                           "AdoDotNet.Query"
                           "AdobeAnalytics.Cubes"
                           "AmazonRedshift.Database"
                           "AnalysisServices.Database"
                           "AnalysisServices.Databases"
                           "Any.Type"
                           "ApacheSpark.Tables"
                           "AtScale.Cubes"
                           "AzureCostManagement.Contents"
                           "AzureCostManagement.Tables"
                           "AzureDevOpsServer.AccountContents"
                           "AzureDevOpsServer.AnalyticsViews"
                           "AzureDevOpsServer.Feed"
                           "AzureDevOpsServer.Views"
                           "AzureEnterprise.Contents"
                           "AzureEnterprise.Tables"
                           "AzureHiveLLAP.Database"
                           "AzureSpark.Tables"
                           "AzureStorage.BlobContents"
                           "AzureStorage.Blobs"
                           "AzureStorage.DataLake"
                           "AzureStorage.DataLakeContents"
                           "AzureStorage.Tables"
                           "BI360.Contents"
                           "BIConnector.Contents"
                           "BIConnector.ContentsX"
                           "Binary.Buffer"
                           "Binary.Combine"
                           "Binary.Compress"
                           "Binary.Decompress"
                           "Binary.From"
                           "Binary.FromList"
                           "Binary.FromText"
                           "Binary.InferContentType"
                           "Binary.Length"
                           "Binary.ToList"
                           "Binary.ToText"
                           "Binary.Type"
                           "BinaryEncoding.Base64"
                           "BinaryEncoding.Hex"
                           "BinaryEncoding.Type"
                           "BinaryFormat.7BitEncodedSignedInteger"
                           "BinaryFormat.7BitEncodedUnsignedInteger"
                           "BinaryFormat.Binary"
                           "BinaryFormat.Byte"
                           "BinaryFormat.ByteOrder"
                           "BinaryFormat.Choice"
                           "BinaryFormat.Decimal"
                           "BinaryFormat.Double"
                           "BinaryFormat.Group"
                           "BinaryFormat.Length"
                           "BinaryFormat.List"
                           "BinaryFormat.Null"
                           "BinaryFormat.Record"
                           "BinaryFormat.SignedInteger16"
                           "BinaryFormat.SignedInteger32"
                           "BinaryFormat.SignedInteger64"
                           "BinaryFormat.Single"
                           "BinaryFormat.Text"
                           "BinaryFormat.Transform"
                           "BinaryFormat.UnsignedInteger16"
                           "BinaryFormat.UnsignedInteger32"
                           "BinaryFormat.UnsignedInteger64"
                           "BinaryOccurrence.Optional"
                           "BinaryOccurrence.Repeating"
                           "BinaryOccurrence.Required"
                           "BinaryOccurrence.Type"
                           "Byte.From"
                           "Byte.Type"
                           "ByteOrder.BigEndian"
                           "ByteOrder.LittleEndian"
                           "ByteOrder.Type"
                           "Cdm.MapToEntity"
                           "Cds.Contents"
                           "Cds.Entities"
                           "Character.FromNumber"
                           "Character.ToNumber"
                           "Character.Type"
                           "Combiner.CombineTextByDelimiter"
                           "Combiner.CombineTextByEachDelimiter"
                           "Combiner.CombineTextByLengths"
                           "Combiner.CombineTextByPositions"
                           "Combiner.CombineTextByRanges"
                           "Comparer.Equals"
                           "Comparer.FromCulture"
                           "Comparer.Ordinal"
                           "Comparer.OrdinalIgnoreCase"
                           "Compression.Deflate"
                           "Compression.GZip"
                           "Compression.Type"
                           "Csv.Document"
                           "CsvStyle.QuoteAfterDelimiter"
                           "CsvStyle.QuoteAlways"
                           "CsvStyle.Type"
                           "Cube.AddAndExpandDimensionColumn"
                           "Cube.AddMeasureColumn"
                           "Cube.ApplyParameter"
                           "Cube.AttributeMemberId"
                           "Cube.AttributeMemberProperty"
                           "Cube.CollapseAndRemoveColumns"
                           "Cube.Dimensions"
                           "Cube.DisplayFolders"
                           "Cube.MeasureProperties"
                           "Cube.MeasureProperty"
                           "Cube.Measures"
                           "Cube.Parameters"
                           "Cube.Properties"
                           "Cube.PropertyKey"
                           "Cube.ReplaceDimensions"
                           "Cube.Transform"
                           "Culture.Current"
                           "Currency.From"
                           "Currency.Type"
                           "CustomerInsights.Contents"
                           "DB2.Database"
                           "DataLake.Contents"
                           "DataLake.Files"
                           "DataWorld.Contents"
                           "DataWorld.Dataset"
                           "Date.AddDays"
                           "Date.AddMonths"
                           "Date.AddQuarters"
                           "Date.AddWeeks"
                           "Date.AddYears"
                           "Date.Day"
                           "Date.DayOfWeek"
                           "Date.DayOfWeekName"
                           "Date.DayOfYear"
                           "Date.DaysInMonth"
                           "Date.EndOfDay"
                           "Date.EndOfMonth"
                           "Date.EndOfQuarter"
                           "Date.EndOfWeek"
                           "Date.EndOfYear"
                           "Date.From"
                           "Date.FromText"
                           "Date.IsInCurrentDay"
                           "Date.IsInCurrentMonth"
                           "Date.IsInCurrentQuarter"
                           "Date.IsInCurrentWeek"
                           "Date.IsInCurrentYear"
                           "Date.IsInNextDay"
                           "Date.IsInNextMonth"
                           "Date.IsInNextNDays"
                           "Date.IsInNextNMonths"
                           "Date.IsInNextNQuarters"
                           "Date.IsInNextNWeeks"
                           "Date.IsInNextNYears"
                           "Date.IsInNextQuarter"
                           "Date.IsInNextWeek"
                           "Date.IsInNextYear"
                           "Date.IsInPreviousDay"
                           "Date.IsInPreviousMonth"
                           "Date.IsInPreviousNDays"
                           "Date.IsInPreviousNMonths"
                           "Date.IsInPreviousNQuarters"
                           "Date.IsInPreviousNWeeks"
                           "Date.IsInPreviousNYears"
                           "Date.IsInPreviousQuarter"
                           "Date.IsInPreviousWeek"
                           "Date.IsInPreviousYear"
                           "Date.IsInYearToDate"
                           "Date.IsLeapYear"
                           "Date.Month"
                           "Date.MonthName"
                           "Date.QuarterOfYear"
                           "Date.StartOfDay"
                           "Date.StartOfMonth"
                           "Date.StartOfQuarter"
                           "Date.StartOfWeek"
                           "Date.StartOfYear"
                           "Date.ToRecord"
                           "Date.ToText"
                           "Date.Type"
                           "Date.WeekOfMonth"
                           "Date.WeekOfYear"
                           "Date.Year"
                           "DateTime.AddZone"
                           "DateTime.Date"
                           "DateTime.FixedLocalNow"
                           "DateTime.From"
                           "DateTime.FromFileTime"
                           "DateTime.FromText"
                           "DateTime.IsInCurrentHour"
                           "DateTime.IsInCurrentMinute"
                           "DateTime.IsInCurrentSecond"
                           "DateTime.IsInNextHour"
                           "DateTime.IsInNextMinute"
                           "DateTime.IsInNextNHours"
                           "DateTime.IsInNextNMinutes"
                           "DateTime.IsInNextNSeconds"
                           "DateTime.IsInNextSecond"
                           "DateTime.IsInPreviousHour"
                           "DateTime.IsInPreviousMinute"
                           "DateTime.IsInPreviousNHours"
                           "DateTime.IsInPreviousNMinutes"
                           "DateTime.IsInPreviousNSeconds"
                           "DateTime.IsInPreviousSecond"
                           "DateTime.LocalNow"
                           "DateTime.Time"
                           "DateTime.ToRecord"
                           "DateTime.ToText"
                           "DateTime.Type"
                           "DateTimeZone.FixedLocalNow"
                           "DateTimeZone.FixedUtcNow"
                           "DateTimeZone.From"
                           "DateTimeZone.FromFileTime"
                           "DateTimeZone.FromText"
                           "DateTimeZone.LocalNow"
                           "DateTimeZone.RemoveZone"
                           "DateTimeZone.SwitchZone"
                           "DateTimeZone.ToLocal"
                           "DateTimeZone.ToRecord"
                           "DateTimeZone.ToText"
                           "DateTimeZone.ToUtc"
                           "DateTimeZone.Type"
                           "DateTimeZone.UtcNow"
                           "DateTimeZone.ZoneHours"
                           "DateTimeZone.ZoneMinutes"
                           "Day.Friday"
                           "Day.Monday"
                           "Day.Saturday"
                           "Day.Sunday"
                           "Day.Thursday"
                           "Day.Tuesday"
                           "Day.Type"
                           "Day.Wednesday"
                           "Decimal.From"
                           "Decimal.Type"
                           "Denodo.Contents"
                           "Diagnostics.ActivityId"
                           "Diagnostics.Trace"
                           "DirectQueryCapabilities.From"
                           "DocumentDB.Contents"
                           "Double.From"
                           "Double.Type"
                           "Dremio.Databases"
                           "Duration.Days"
                           "Duration.From"
                           "Duration.FromText"
                           "Duration.Hours"
                           "Duration.Minutes"
                           "Duration.Seconds"
                           "Duration.ToRecord"
                           "Duration.ToText"
                           "Duration.TotalDays"
                           "Duration.TotalHours"
                           "Duration.TotalMinutes"
                           "Duration.TotalSeconds"
                           "Duration.Type"
                           "Dynamics365BusinessCentral.Contents"
                           "Dynamics365BusinessCentralOnPremises.Contents"
                           "DynamicsNav.Contents"
                           "Embedded.Value"
                           "Emigo.Contents"
                           "Emigo.GetExtractFunction"
                           "EmigoDataSourceConnector.GetExtractFunction"
                           "EmigoDataSourceConnector.NavigationFunctionType"
                           "EntersoftBusinessSuite.Contents"
                           "Error.Record"
                           "Essbase.Cubes"
                           "Exasol.Database"
                           "Excel.CurrentWorkbook"
                           "Excel.Workbook"
                           "Exchange.Contents"
                           "Expression.Constant"
                           "Expression.Evaluate"
                           "Expression.Identifier"
                           "ExtraValues.Error"
                           "ExtraValues.Ignore"
                           "ExtraValues.List"
                           "ExtraValues.Type"
                           "Facebook.Graph"
                           "File.Contents"
                           "Folder.Contents"
                           "Folder.Files"
                           "Function.From"
                           "Function.Invoke"
                           "Function.InvokeAfter"
                           "Function.IsDataSource"
                           "Function.ScalarVector"
                           "Function.Type"
                           "Github.Contents"
                           "Github.PagedTable"
                           "Github.Tables"
                           "GoogleAnalytics.Accounts"
                           "GoogleBigQuery.Database"
                           "GroupKind.Global"
                           "GroupKind.Local"
                           "GroupKind.Type"
                           "Guid.From"
                           "Guid.Type"
                           "HdInsight.Containers"
                           "HdInsight.Contents"
                           "HdInsight.Files"
                           "Hdfs.Contents"
                           "Hdfs.Files"
                           "Html.Table"
                           "IRIS.Database"
                           "Identity.From"
                           "Identity.IsMemberOf"
                           "Identity.Type"
                           "IdentityProvider.Default"
                           "IdentityProvider.Type"
                           "Impala.Database"
                           "Indexima.Database"
                           "IndustrialAppStore.DataSearch"
                           "IndustrialAppStore.NavigationTable"
                           "IndustrialAppStore.TagSearch"
                           "InformationGrid.Contents"
                           "Informix.Database"
                           "Int16.From"
                           "Int16.Type"
                           "Int32.From"
                           "Int32.Type"
                           "Int64.From"
                           "Int64.Type"
                           "Int8.From"
                           "Int8.Type"
                           "Intune.Contents"
                           "ItemExpression.From"
                           "ItemExpression.Item"
                           "JethroODBC.Database"
                           "JoinAlgorithm.Dynamic"
                           "JoinAlgorithm.LeftHash"
                           "JoinAlgorithm.LeftIndex"
                           "JoinAlgorithm.PairwiseHash"
                           "JoinAlgorithm.RightHash"
                           "JoinAlgorithm.RightIndex"
                           "JoinAlgorithm.SortMerge"
                           "JoinAlgorithm.Type"
                           "JoinKind.FullOuter"
                           "JoinKind.Inner"
                           "JoinKind.LeftAnti"
                           "JoinKind.LeftOuter"
                           "JoinKind.RightAnti"
                           "JoinKind.RightOuter"
                           "JoinKind.Type"
                           "JoinSide.Left"
                           "JoinSide.Right"
                           "JoinSide.Type"
                           "Json.Document"
                           "Json.FromValue"
                           "Kusto.Contents"
                           "Kusto.Databases"
                           "Kyligence.Database"
                           "LimitClauseKind.AnsiSql2008"
                           "LimitClauseKind.Limit"
                           "LimitClauseKind.LimitOffset"
                           "LimitClauseKind.None"
                           "LimitClauseKind.Top"
                           "LimitClauseKind.Type"
                           "Lines.FromBinary"
                           "Lines.FromText"
                           "Lines.ToBinary"
                           "Lines.ToText"
                           "List.Accumulate"
                           "List.AllTrue"
                           "List.Alternate"
                           "List.AnyTrue"
                           "List.Average"
                           "List.Buffer"
                           "List.Combine"
                           "List.Contains"
                           "List.ContainsAll"
                           "List.ContainsAny"
                           "List.Count"
                           "List.Covariance"
                           "List.DateTimeZones"
                           "List.DateTimes"
                           "List.Dates"
                           "List.Difference"
                           "List.Distinct"
                           "List.Durations"
                           "List.FindText"
                           "List.First"
                           "List.FirstN"
                           "List.Generate"
                           "List.InsertRange"
                           "List.Intersect"
                           "List.IsDistinct"
                           "List.IsEmpty"
                           "List.Last"
                           "List.LastN"
                           "List.MatchesAll"
                           "List.MatchesAny"
                           "List.Max"
                           "List.MaxN"
                           "List.Median"
                           "List.Min"
                           "List.MinN"
                           "List.Mode"
                           "List.Modes"
                           "List.NonNullCount"
                           "List.Numbers"
                           "List.PositionOf"
                           "List.PositionOfAny"
                           "List.Positions"
                           "List.Product"
                           "List.Random"
                           "List.Range"
                           "List.RemoveFirstN"
                           "List.RemoveItems"
                           "List.RemoveLastN"
                           "List.RemoveMatchingItems"
                           "List.RemoveNulls"
                           "List.RemoveRange"
                           "List.Repeat"
                           "List.ReplaceMatchingItems"
                           "List.ReplaceRange"
                           "List.ReplaceValue"
                           "List.Reverse"
                           "List.Select"
                           "List.Single"
                           "List.SingleOrDefault"
                           "List.Skip"
                           "List.Sort"
                           "List.Split"
                           "List.StandardDeviation"
                           "List.Sum"
                           "List.Times"
                           "List.Transform"
                           "List.TransformMany"
                           "List.Type"
                           "List.Union"
                           "List.Zip"
                           "Logical.From"
                           "Logical.FromText"
                           "Logical.ToText"
                           "Logical.Type"
                           "MailChimp.Collection"
                           "MailChimp.Instance"
                           "MailChimp.Tables"
                           "MailChimp.TablesV2"
                           "MarkLogicODBC.Contents"
                           "Marketo.Activities"
                           "Marketo.Leads"
                           "Marketo.Tables"
                           "MicrosoftAzureConsumptionInsights.Contents"
                           "MicrosoftAzureConsumptionInsights.Tables"
                           "MicrosoftAzureConsumptionInsights.Test"
                           "MicrosoftGraphSecurity.Contents"
                           "MissingField.Error"
                           "MissingField.Ignore"
                           "MissingField.Type"
                           "MissingField.UseNull"
                           "Mixpanel.Contents"
                           "Mixpanel.Export"
                           "Mixpanel.FunnelById"
                           "Mixpanel.FunnelByName"
                           "Mixpanel.Funnels"
                           "Mixpanel.Segmentation"
                           "Mixpanel.Tables"
                           "MySQL.Database"
                           "Netezza.Database"
                           "None.Type"
                           "Null.Type"
                           "Number.Abs"
                           "Number.Acos"
                           "Number.Asin"
                           "Number.Atan"
                           "Number.Atan2"
                           "Number.BitwiseAnd"
                           "Number.BitwiseNot"
                           "Number.BitwiseOr"
                           "Number.BitwiseShiftLeft"
                           "Number.BitwiseShiftRight"
                           "Number.BitwiseXor"
                           "Number.Combinations"
                           "Number.Cos"
                           "Number.Cosh"
                           "Number.E"
                           "Number.Epsilon"
                           "Number.Exp"
                           "Number.Factorial"
                           "Number.From"
                           "Number.FromText"
                           "Number.IntegerDivide"
                           "Number.IsEven"
                           "Number.IsNaN"
                           "Number.IsOdd"
                           "Number.Ln"
                           "Number.Log"
                           "Number.Log10"
                           "Number.Mod"
                           "Number.NaN"
                           "Number.NegativeInfinity"
                           "Number.PI"
                           "Number.Permutations"
                           "Number.PositiveInfinity"
                           "Number.Power"
                           "Number.Random"
                           "Number.RandomBetween"
                           "Number.Round"
                           "Number.RoundAwayFromZero"
                           "Number.RoundDown"
                           "Number.RoundTowardZero"
                           "Number.RoundUp"
                           "Number.Sign"
                           "Number.Sin"
                           "Number.Sinh"
                           "Number.Sqrt"
                           "Number.Tan"
                           "Number.Tanh"
                           "Number.ToText"
                           "Number.Type"
                           "OData.Feed"
                           "ODataOmitValues.Nulls"
                           "ODataOmitValues.Type"
                           "Occurrence.All"
                           "Occurrence.First"
                           "Occurrence.Last"
                           "Occurrence.Optional"
                           "Occurrence.Repeating"
                           "Occurrence.Required"
                           "Occurrence.Type"
                           "Odbc.DataSource"
                           "Odbc.InferOptions"
                           "Odbc.Query"
                           "OleDb.DataSource"
                           "OleDb.Query"
                           "Oracle.Database"
                           "Order.Ascending"
                           "Order.Descending"
                           "Order.Type"
                           "PQGoogleSpreadsheet.Contents"
                           "PQGoogleSpreadsheetCore.Contents"
                           "Password.Type"
                           "Paxata.Contents"
                           "Pdf.Tables"
                           "Percentage.From"
                           "Percentage.Type"
                           "PlanviewEnterprise.CallQueryService"
                           "PlanviewEnterprise.Feed"
                           "PostgreSQL.Database"
                           "PowerBI.Dataflows"
                           "Precision.Decimal"
                           "Precision.Double"
                           "Precision.Type"
                           "Projectplace.Feed"
                           "Python.Execute"
                           "QubolePresto.Contents"
                           "QuickBase.Contents"
                           "QuickBooks.Query"
                           "QuickBooks.Report"
                           "QuickBooks.Tables"
                           "QuickBooksOnline.Tables"
                           "QuoteStyle.Csv"
                           "QuoteStyle.None"
                           "QuoteStyle.Type"
                           "R.Execute"
                           "RData.FromBinary"
                           "Record.AddField"
                           "Record.Combine"
                           "Record.Field"
                           "Record.FieldCount"
                           "Record.FieldNames"
                           "Record.FieldOrDefault"
                           "Record.FieldValues"
                           "Record.FromList"
                           "Record.FromTable"
                           "Record.HasFields"
                           "Record.RemoveFields"
                           "Record.RenameFields"
                           "Record.ReorderFields"
                           "Record.SelectFields"
                           "Record.ToList"
                           "Record.ToTable"
                           "Record.TransformFields"
                           "Record.Type"
                           "RelativePosition.FromEnd"
                           "RelativePosition.FromStart"
                           "RelativePosition.Type"
                           "Replacer.ReplaceText"
                           "Replacer.ReplaceValue"
                           "Resource.Access"
                           "Roamler.Contents"
                           "RoundingMode.AwayFromZero"
                           "RoundingMode.Down"
                           "RoundingMode.ToEven"
                           "RoundingMode.TowardZero"
                           "RoundingMode.Type"
                           "RoundingMode.Up"
                           "RowExpression.Column"
                           "RowExpression.From"
                           "RowExpression.Row"
                           "Salesforce.Data"
                           "Salesforce.Reports"
                           "SapBusinessWarehouse.Cubes"
                           "SapBusinessWarehouseExecutionMode.BasXml"
                           "SapBusinessWarehouseExecutionMode.BasXmlGzip"
                           "SapBusinessWarehouseExecutionMode.DataStream"
                           "SapBusinessWarehouseExecutionMode.Type"
                           "SapHana.Database"
                           "SapHanaDistribution.All"
                           "SapHanaDistribution.Connection"
                           "SapHanaDistribution.Off"
                           "SapHanaDistribution.Statement"
                           "SapHanaDistribution.Type"
                           "SapHanaRangeOperator.Equals"
                           "SapHanaRangeOperator.GreaterThan"
                           "SapHanaRangeOperator.GreaterThanOrEquals"
                           "SapHanaRangeOperator.LessThan"
                           "SapHanaRangeOperator.LessThanOrEquals"
                           "SapHanaRangeOperator.NotEquals"
                           "SapHanaRangeOperator.Type"
                           "SharePoint.Contents"
                           "SharePoint.Files"
                           "SharePoint.Tables"
                           "Single.From"
                           "Single.Type"
                           "Smartsheet.Content"
                           "Smartsheet.Query"
                           "Smartsheet.Tables"
                           "Snowflake.Databases"
                           "Soda.Feed"
                           "Spark.Tables"
                           "SparkPost.GetList"
                           "SparkPost.GetTable"
                           "SparkPost.NavTable"
                           "SparkProtocol.Azure"
                           "SparkProtocol.HTTP"
                           "SparkProtocol.Standard"
                           "SparkProtocol.Type"
                           "Splitter.SplitByNothing"
                           "Splitter.SplitTextByAnyDelimiter"
                           "Splitter.SplitTextByCharacterTransition"
                           "Splitter.SplitTextByDelimiter"
                           "Splitter.SplitTextByEachDelimiter"
                           "Splitter.SplitTextByLengths"
                           "Splitter.SplitTextByPositions"
                           "Splitter.SplitTextByRanges"
                           "Splitter.SplitTextByRepeatedLengths"
                           "Splitter.SplitTextByWhitespace"
                           "Sql.Database"
                           "Sql.Databases"
                           "SqlExpression.SchemaFrom"
                           "SqlExpression.ToExpression"
                           "Stripe.Contents"
                           "Stripe.Method"
                           "Stripe.Tables"
                           "SurveyMonkey.Contents"
                           "SweetIQ.Contents"
                           "SweetIQ.Tables"
                           "Sybase.Database"
                           "Table.AddColumn"
                           "Table.AddIndexColumn"
                           "Table.AddJoinColumn"
                           "Table.AddKey"
                           "Table.AggregateTableColumn"
                           "Table.AlternateRows"
                           "Table.Buffer"
                           "Table.Column"
                           "Table.ColumnCount"
                           "Table.ColumnNames"
                           "Table.ColumnsOfType"
                           "Table.Combine"
                           "Table.CombineColumns"
                           "Table.Contains"
                           "Table.ContainsAll"
                           "Table.ContainsAny"
                           "Table.DemoteHeaders"
                           "Table.Distinct"
                           "Table.DuplicateColumn"
                           "Table.ExpandListColumn"
                           "Table.ExpandRecordColumn"
                           "Table.ExpandTableColumn"
                           "Table.FillDown"
                           "Table.FillUp"
                           "Table.FilterWithDataTable"
                           "Table.FindText"
                           "Table.First"
                           "Table.FirstN"
                           "Table.FirstValue"
                           "Table.FromColumns"
                           "Table.FromList"
                           "Table.FromPartitions"
                           "Table.FromRecords"
                           "Table.FromRows"
                           "Table.FromValue"
                           "Table.FuzzyJoin"
                           "Table.FuzzyNestedJoin"
                           "Table.Group"
                           "Table.HasColumns"
                           "Table.InsertRows"
                           "Table.IsDistinct"
                           "Table.IsEmpty"
                           "Table.Join"
                           "Table.Keys"
                           "Table.Last"
                           "Table.LastN"
                           "Table.MatchesAllRows"
                           "Table.MatchesAnyRows"
                           "Table.Max"
                           "Table.MaxN"
                           "Table.Min"
                           "Table.MinN"
                           "Table.NestedJoin"
                           "Table.Partition"
                           "Table.PartitionValues"
                           "Table.Pivot"
                           "Table.PositionOf"
                           "Table.PositionOfAny"
                           "Table.PrefixColumns"
                           "Table.Profile"
                           "Table.PromoteHeaders"
                           "Table.Range"
                           "Table.RemoveColumns"
                           "Table.RemoveFirstN"
                           "Table.RemoveLastN"
                           "Table.RemoveMatchingRows"
                           "Table.RemoveRows"
                           "Table.RemoveRowsWithErrors"
                           "Table.RenameColumns"
                           "Table.ReorderColumns"
                           "Table.Repeat"
                           "Table.ReplaceErrorValues"
                           "Table.ReplaceKeys"
                           "Table.ReplaceMatchingRows"
                           "Table.ReplaceRelationshipIdentity"
                           "Table.ReplaceRows"
                           "Table.ReplaceValue"
                           "Table.ReverseRows"
                           "Table.RowCount"
                           "Table.Schema"
                           "Table.SelectColumns"
                           "Table.SelectRows"
                           "Table.SelectRowsWithErrors"
                           "Table.SingleRow"
                           "Table.Skip"
                           "Table.Sort"
                           "Table.Split"
                           "Table.SplitColumn"
                           "Table.ToColumns"
                           "Table.ToList"
                           "Table.ToRecords"
                           "Table.ToRows"
                           "Table.TransformColumnNames"
                           "Table.TransformColumnTypes"
                           "Table.TransformColumns"
                           "Table.TransformRows"
                           "Table.Transpose"
                           "Table.Type"
                           "Table.Unpivot"
                           "Table.UnpivotOtherColumns"
                           "Table.View"
                           "Table.ViewFunction"
                           "Tables.GetRelationships"
                           "TeamDesk.Database"
                           "TeamDesk.Select"
                           "TeamDesk.SelectView"
                           "Tenforce.Contents"
                           "Teradata.Database"
                           "Text.AfterDelimiter"
                           "Text.At"
                           "Text.BeforeDelimiter"
                           "Text.BetweenDelimiters"
                           "Text.Clean"
                           "Text.Combine"
                           "Text.Contains"
                           "Text.End"
                           "Text.EndsWith"
                           "Text.Format"
                           "Text.From"
                           "Text.FromBinary"
                           "Text.InferNumberType"
                           "Text.Insert"
                           "Text.Length"
                           "Text.Lower"
                           "Text.Middle"
                           "Text.NewGuid"
                           "Text.PadEnd"
                           "Text.PadStart"
                           "Text.PositionOf"
                           "Text.PositionOfAny"
                           "Text.Proper"
                           "Text.Range"
                           "Text.Remove"
                           "Text.RemoveRange"
                           "Text.Repeat"
                           "Text.Replace"
                           "Text.ReplaceRange"
                           "Text.Reverse"
                           "Text.Select"
                           "Text.Split"
                           "Text.SplitAny"
                           "Text.Start"
                           "Text.StartsWith"
                           "Text.ToBinary"
                           "Text.ToList"
                           "Text.Trim"
                           "Text.TrimEnd"
                           "Text.TrimStart"
                           "Text.Type"
                           "Text.Upper"
                           "TextEncoding.Ascii"
                           "TextEncoding.BigEndianUnicode"
                           "TextEncoding.Type"
                           "TextEncoding.Unicode"
                           "TextEncoding.Utf16"
                           "TextEncoding.Utf8"
                           "TextEncoding.Windows"
                           "Time.EndOfHour"
                           "Time.From"
                           "Time.FromText"
                           "Time.Hour"
                           "Time.Minute"
                           "Time.Second"
                           "Time.StartOfHour"
                           "Time.ToRecord"
                           "Time.ToText"
                           "Time.Type"
                           "TraceLevel.Critical"
                           "TraceLevel.Error"
                           "TraceLevel.Information"
                           "TraceLevel.Type"
                           "TraceLevel.Verbose"
                           "TraceLevel.Warning"
                           "Troux.CustomFeed"
                           "Troux.Feed"
                           "Troux.TestConnection"
                           "Twilio.Contents"
                           "Twilio.Tables"
                           "Twilio.URL"
                           "Type.AddTableKey"
                           "Type.ClosedRecord"
                           "Type.Facets"
                           "Type.ForFunction"
                           "Type.ForRecord"
                           "Type.FunctionParameters"
                           "Type.FunctionRequiredParameters"
                           "Type.FunctionReturn"
                           "Type.Is"
                           "Type.IsNullable"
                           "Type.IsOpenRecord"
                           "Type.ListItem"
                           "Type.NonNullable"
                           "Type.OpenRecord"
                           "Type.RecordFields"
                           "Type.ReplaceFacets"
                           "Type.ReplaceTableKeys"
                           "Type.TableColumn"
                           "Type.TableKeys"
                           "Type.TableRow"
                           "Type.TableSchema"
                           "Type.Type"
                           "Type.Union"
                           "Uri.BuildQueryString"
                           "Uri.Combine"
                           "Uri.EscapeDataString"
                           "Uri.Parts"
                           "Uri.Type"
                           "VSTS.AccountContents"
                           "VSTS.AnalyticsViews"
                           "VSTS.Contents"
                           "VSTS.Feed"
                           "VSTS.Views"
                           "Value.Add"
                           "Value.As"
                           "Value.Compare"
                           "Value.Divide"
                           "Value.Equals"
                           "Value.Firewall"
                           "Value.FromText"
                           "Value.Is"
                           "Value.Metadata"
                           "Value.Multiply"
                           "Value.NativeQuery"
                           "Value.NullableEquals"
                           "Value.RemoveMetadata"
                           "Value.ReplaceMetadata"
                           "Value.ReplaceType"
                           "Value.ResourceExpression"
                           "Value.Subtract"
                           "Value.Type"
                           "Variable.Value"
                           "Vertica.Database"
                           "Web.BrowserContents"
                           "Web.Contents"
                           "Web.Page"
                           "WebAction.Request"
                           "WebMethod.Delete"
                           "WebMethod.Get"
                           "WebMethod.Head"
                           "WebMethod.Patch"
                           "WebMethod.Post"
                           "WebMethod.Put"
                           "WebMethod.Type"
                           "Webtrends.KeyMetrics"
                           "Webtrends.Profile"
                           "Webtrends.ReportContents"
                           "Webtrends.Tables"
                           "WorkforceDimensions.Contents"
                           "Xml.Document"
                           "Xml.Tables"
                           "Zendesk.Collection"
                           "Zendesk.Tables"
                           "appFigures.Content"
                           "appFigures.Tables"
                           "tyGraph.Feed"
                           "tyGraph.NavTable"
                           ))

            ;; generate regex string for each category of keywords
            (x-keywords-regexp (regexp-opt x-keywords 'words))
            ;(x-types-regexp (regexp-opt x-types 'words))
            ;(x-constants-regexp (regexp-opt x-constants 'words))
            ;(x-events-regexp (regexp-opt x-events 'words))
            (x-functions-regexp (regexp-opt x-functions 'words)))

        `(
          ;(,x-types-regexp . font-lock-type-face)
          ;(,x-constants-regexp . font-lock-constant-face)
          ;(,x-events-regexp . font-lock-builtin-face)
          (,x-functions-regexp . font-lock-function-name-face)
          (,x-keywords-regexp . font-lock-keyword-face)
          ;; note: order above matters, because once colored, that part won't change.
          ;; in general, put longer words first
          )))

;;;###autoload
(define-derived-mode power-query-mode c-mode "power-query mode"
  "Major mode for editing POWER-QUERY ( Language)â¦"

  ;; code for syntax highlighting
  (setq font-lock-defaults '(power-query-font-lock-keywords nil t))
  (set (make-local-variable 'indent-line-function) #'indent-relative)
  )

;; add the mode to the `features' list
(provide 'power-query-mode)

;;; power-query-mode.el ends here
